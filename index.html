<!-- ============================================================================
     DELTA GREEN STATS - Character Creator & Exporter for Foundry VTT
     ============================================================================
     This HTML file defines the structure for a complete Delta Green RPG character
     creation and management tool with Foundry VTT export support.
     
     Key Sections:
     - Stat management (point buy, random roll, dice roll)
     - Character sheet with skills and specialties
     - Biography and character details
     - Bond generation and management system
     - JSON preview and export to Foundry format
     
     Styling: styles.css (organized by component)
     Logic: scripts.js (character generation, export)
     Bonds: bonds.js (bond category data)
     ============================================================================ -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- Title of the webpage -->
    <title>Delta Green Point Buy</title>
    <meta name="description"
        content="Delta Green Point Buy allows you to strategically allocate stats for your Delta Green characters. Explore options for PISCES (UK), DELTA GREEN (US), and more.">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "WebApplication",
          "name": "Delta Green Point Buy",
          "description": "Delta Green Point Buy allows you to strategically allocate stats for your Delta Green characters. Explore options for PISCES (UK), DELTA GREEN (US), and more.",
          "url": "https://pigeonfx.github.io/DELTA-GREEN-STATS/"
        }
        </script>
</head>

<body>
    <div class="page-title">DELTA GREEN STATS TERMINAL...&gt;<span class="blinking-cursor">_</span></div>
    <div class="content">
        <div class="stats-section">
            <h2>STATISTICS:</h2>
            <div id="stats"></div>
            <div class="total-points">Remaining Points: <span id="totalPoints">72</span></div>
        </div>
        <!-- Move the text box to the left -->
        <div class="text-box text-box-left" id="bondText"></div>
        <!-- Move the bond categories form to the right -->
        <form id="bond-categories" class="bond-categories">
            <label for="PISCES_UK">
                <input type="checkbox" id="PISCES_UK" name="bond-category" value="PISCES_UK">
                PISCES (UK)
            </label>
            <label for="DELTA_GREEN">
                <input type="checkbox" id="DELTA_GREEN" name="bond-category" value="DELTA_GREEN" checked>
                DELTA GREEN (US)
            </label>
            <label for="FRIENDS_FAMILY">
                <input type="checkbox" id="FRIENDS_FAMILY" name="bond-category" value="FRIENDS_FAMILY">
                FRIENDS & FAMILY
            </label>
            <label for="UNDERWORLD">
                <input type="checkbox" id="UNDERWORLD" name="bond-category" value="UNDERWORLD">
                UNDERWORLD
            </label>
            <label for="LGBTQ">
                <input type="checkbox" id="LGBTQ" name="bond-category" value="LGBTQ">
                LGBTQ
    </div>
    <div class="button-container">
        <button type="button" id="random-point-buy"
            title="Will distribute 72 points across the six stats using a random allocation algorithm."
            onclick="randomStats()">RANDOM POINT BUY</button>
        <button type="button" id="random-dice-roll"
            title="Will roll 4xD6 and keep the three highest rolls. It will then update the value of each stat."
            onclick="randomDiceRoll()">RANDOM DICE ROLL</button>
        <button type="button" id="reset-button"
            title="Will reset all stats to their default value of 3 and take you back to the Point Buy system with 54 points to spend on your stats for a total of 72 points."
            onclick="resetStats()">RESET</button>
        <button type="button" id="bonds-button"
            title="Will randomly generate a bond based on the selected categories and display it in the text box."
            onclick="generateRandomBond()">GENERATE BOND</button>
        <button type="button" id="add-bond-button" title="Add the generated bond to your character sheet."
            onclick="addBondToSheet()">ADD TO SHEET</button>

    </div>
    <!-- Character sheet section -->
    <div class="content">
        <div class="stats-section">
            <h2>CHARACTER SHEET (Foundry VTT export)</h2>
            <div id="character-sheet">
                <label>Name: <input type="text" id="cs-name" value="Agent"></label><br>
                <input type="hidden" id="cs-img" value="assets/art/logo.png">
                <input type="hidden" id="cs-type" value="agent">
                <fieldset class="panel panel-stats" style="margin-top:8px;border:1px solid #00b521;padding:8px;">
                    <legend>Statistics & Derived Attributes (editable)</legend>
                    <div class="stats-derived-grid">
                        <div>
                            <div id="cs-stats"><!-- populated by JS --></div>
                        </div>
                        <div>
                            <div class="stat-container"><span class="stat-label">HP</span><input type="number"
                                    id="cs-hp" value="0" min="0" class="stat-input"></div>
                            <div class="stat-container"><span class="stat-label">WP</span><input type="number"
                                    id="cs-wp" value="0" min="0" class="stat-input"></div>
                            <div class="stat-container"><span class="stat-label">SAN</span><input type="number"
                                    id="cs-sanity-value" value="50" min="0" class="stat-input"></div>
                            <div class="stat-container"><span class="stat-label">BP</span><input type="number"
                                    id="cs-breaking-point" value="40" min="0" class="stat-input"></div>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="panel panel-profession" style="margin-top:8px;border:1px solid #00b521;padding:8px;">
                    <legend>Profession</legend>
                    <label for="cs-profession-select">Select Profession:</label>
                    <select id="cs-profession-select" onchange="selectProfession(this.value)">
                        <option value="">-- Choose a Profession --</option>
                    </select>
                    <div id="cs-profession-info"
                        style="margin-top:12px;font-size:0.9em;line-height:1.6;white-space:pre-wrap;"></div>
                    <div id="cs-profession-optional-skills" style="margin-top:12px;"></div>
                    <button type="button" id="apply-profession-button" onclick="applyProfessionSkills()"
                        style="margin-top:12px;padding:6px 12px;width:auto;display:none;">Apply Professional
                        Skills</button>
                </fieldset>

                <fieldset class="panel panel-skills" style="margin-top:8px;border:1px solid #00b521;padding:8px;">
                    <legend>Skills</legend>
                    <div id="cs-skills"> <!-- skill inputs created by JS --> </div>
                    <button type="button" id="add-skill-button" onclick="addCustomSkill()"
                        style="margin-top:12px;padding:6px 12px;width:auto;">Add Skill</button>
                    <div id="cs-custom-skills"></div>
                </fieldset>

                <fieldset id="cs-biography-fieldset" class="panel panel-bio"
                    style="margin-top:8px;border:1px solid #00b521;padding:8px;">
                    <legend>Biography</legend>
                    <label>Profession: <input type="text" id="cs-bio-profession" value=""></label>
                    <label>Employer: <input type="text" id="cs-bio-employer" value=""></label>
                    <label>Nationality: <input type="text" id="cs-bio-nationality" value=""></label>
                    <label>Sex: <input type="text" id="cs-bio-sex" value=""></label>
                    <label>Age: <input type="number" id="cs-bio-age" value="" min="0"></label>
                    <label>Education: <input type="text" id="cs-bio-education" value=""></label>
                    <label style="display:block;margin-top:8px">Physical Description:</label>
                    <textarea id="cs-physical-desc" style="width:100%;height:120px"
                        placeholder="Physical description of agent"></textarea>
                </fieldset>

                <fieldset style="margin-top:8px;border:1px solid #00b521;padding:8px;" id="cs-bonds-fieldset">
                    <legend>Bonds</legend>
                    <div id="cs-bonds">
                        <p style="opacity:0.8;margin:0;">(No bonds yet â€” bonds UI will be added here.)</p>
                    </div>
                </fieldset>

                <fieldset class="panel panel-proto" style="margin-top:8px;border:1px solid #00b521;padding:8px;">
                    <legend>Prototype Token / Misc JSON</legend>
                    <label>Prototype Token (JSON):</label>
                    <textarea id="cs-prototype-json" style="width:100%;height:140px">{
  "actorLink": true,
  "name": "Agent",
  "width": 1,
  "height": 1,
  "texture": { "src": "icons/svg/mystery-man.svg" }
}</textarea>
                    <label>Items (JSON array):</label>
                    <textarea id="cs-items-json" style="width:100%;height:140px">[{
  "name": "Unarmed Attack",
  "type": "weapon",
  "flags": { "deltagreen": { "AutoAdded": true, "SystemName": "unarmed-attack" } },
  "img": "systems/deltagreen/assets/icons/punch.svg",
  "system": { "skill": "unarmed_combat", "damage": "1D4-1", "equipped": true }
}]</textarea>
                </fieldset>

                <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;">
                    <button type="button" id="preview-json" onclick="populateCharacterJSON()">Preview Foundry
                        JSON</button>
                    <button type="button" id="export-json" onclick="exportCharacterJSON()">Export Foundry JSON</button>
                    <button type="button" id="refresh-stats" onclick="populateCharacterSheetForm()">Refresh fields from
                        Stats</button>
                </div>
                <pre id="cs-json"
                    style="display:none;white-space:pre-wrap;padding:10px;margin-top:10px;max-height:400px;overflow:auto;"></pre>
            </div>
        </div>
    </div>
    <!-- Theme selector -->
    <div id="theme-selector">
        <label>Theme:</label>
        <select id="cs-theme-select" aria-label="Theme selector">
            <option value="xfiles">X-Files</option>
            <option value="modern">Modern</option>
        </select>
    </div>
    <div class="github-link-container">
        <a href="https://github.com/PigeonFX/DELTA-GREEN-STATS" target="_blank">GitHub</a>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="professions.js"></script>
    <script src="bonds.js"></script>
    <script src="scripts.js"></script>
</body>

</html>